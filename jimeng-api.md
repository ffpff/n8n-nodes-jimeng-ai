# 即梦AI 文生图3.1「提交任务」接口文档（整理版）
---

## 概述

- 能力：文生图3.1 是与「即梦」同源的文本生成图像能力，重点升级画面美感、风格精准多样与细节丰富度，并兼具文字响应效果。
- 接口域名：https://visual.volcengineapi.com
- 主要操作：提交异步任务，获得 task_id，用于后续查询结果。

---

## 接入说明

### 请求方式

- Method：POST
- Content-Type：application/json

### 接口地址

- 基础 URL：https://visual.volcengineapi.com

---

## 提交任务

### Query 参数（拼接在 URL 上）

示例：
- https://visual.volcengineapi.com?Action=CVSync2AsyncSubmitTask&Version=2022-08-31

参数说明：
- Action（string，必选）：接口名，取值：CVSync2AsyncSubmitTask
- Version（string，必选）：版本号，取值：2022-08-31

### Header 参数

- Region：cn-north-1（固定值）
- Service：cv（固定值）
- 用途：签名与鉴权。详见「公共参数 - 签名参数 - 在 Header 中的场景」。

### Body 参数（application/json）

注意：
- 业务请求参数放在 request.body 中
- MIME-Type 为 application/json

参数列表：
- req_key（string，必选）
  - 算法名称，固定值：jimeng_t2i_v31
- prompt（string，必选）
  - 用于生成图像的提示词，中英文均可
  - 建议长度 <= 120 字符，最大不超过 800 字符
  - 过长可能导致出图异常或不生效
- use_pre_llm（bool，可选）
  - 是否开启文本扩写，针对输入 prompt 进行扩写优化
  - 建议：若 prompt 较短则开启，较长则关闭
  - 默认：true
- seed（int，可选）
  - 随机种子，决定扩散初始状态
  - 默认：-1（随机）
  - 若 seed 为相同正整数且其他参数一致，则生成结果大概率一致
- width（int，可选）
  - 生成图像宽度（需与 height 同时传递方可生效）
  - 支持范围：长度在 [512, 2048] 之间；宽高比在 1:3 到 3:1 之间
  - 系统默认生成 1328×1328
- height（int，可选）
  - 生成图像高度（需与 width 同时传递方可生效）

推荐分辨率（宽×高）：
- 标清 1K：
  - 1328×1328（1:1）
  - 1472×1104（4:3）
  - 1584×1056（3:2）
  - 1664×936（16:9）
  - 2016×864（21:9）
- 高清 2K：
  - 2048×2048（1:1）
  - 2304×1728（4:3）
  - 2496×1664（3:2）
  - 2560×1440（16:9）
  - 3024×1296（21:9）

注意：
- 同时传 width 与 height 才会生效；否则使用系统默认 1328×1328。

---

## 返回值

- 返回包含通用返回字段与错误码（参见平台通用说明）。
- 业务字段（data 下重点关注）：
  - task_id（string）：任务 ID，用于后续查询结果。

---

## 示例

- URL：
  - https://visual.volcengineapi.com?Action=CVSync2AsyncSubmitTask&Version=2022-08-31
- Header：
  - Region: cn-north-1
  - Service: cv
  - Content-Type: application/json
  - 其余签名相关 Header 参见公共参数说明
- Body（示例）：
  ````json
  {
    "req_key": "jimeng_t2i_v31",
    "prompt": "a serene landscape with mountains and a clear lake at sunrise, ultra-detailed, cinematic lighting",
    "use_pre_llm": true,
    "seed": 123456,
    "width": 1664,
    "height": 936
  }
  ````

# 即梦 AI 文生图「查询任务」接口文档（整理版）

本接口用于查询异步任务的处理结果。

- 接口地址示例: https://visual.volcengineapi.com?Action=CVSync2AsyncGetResult&Version=2022-08-31
- 固定参数：
  - Action: CVSync2AsyncGetResult
  - Version: 2022-08-31
- Header 固定值（用于鉴权，详见“公共参数-签名参数-在Header中的场景”）：
  - Region: cn-north-1
  - Service: cv

---

## 1. Query 参数（拼接到 URL）

- Action: string，必选，固定值：CVSync2AsyncGetResult
- Version: string，必选，固定值：2022-08-31

示例：
- https://visual.volcengineapi.com?Action=CVSync2AsyncGetResult&Version=2022-08-31

---

## 2. Header 参数（鉴权）

- 注意：本服务固定值
  - Region: cn-north-1
  - Service: cv
- 主要用于签名鉴权，详见公共参数文档（在 Header 中的场景）

---

## 3. Body 参数

- 说明：业务请求参数放入 request.body，MIME-Type 为 application/json

字段说明：
- req_key: string，必选
  - 服务标识，固定值：jimeng_t2i_v31
- task_id: string，必选
  - 任务 ID，取值为“提交任务接口”的返回
- req_json: JSON string，可选
  - JSON 序列化后的字符串
  - 支持配置水印和是否以图片链接形式返回等

示例说明（语义化示例，实际需用合法 JSON 序列化后赋给 req_json）：
- 包含水印配置与返回 URL 的配置

---

## 4. 配置信息（req_json 内部可选项）

- return_url: bool，可选  
  - 是否返回图片链接（链接有效期 24 小时）
- logo_info: LogoInfo，可选  
  - 水印信息（见下文“LogoInfo”）
- aigc_meta: AIGCMeta，可选  
  - 隐式标识（见下文“AIGCMeta”）

隐式标识验证方式：
1. 查看 png 或 mp4 格式：人工智能生成合成内容表示服务平台（后续预计增加 jpg）
   - https://www.gcmark.com/web/index.html#/mark/check/image
2. 查看 jpg 格式：使用 app11 segment 查看 AIGC 元数据内容
   - https://cyber.meme.tips/jpdump/#

---

## 5. LogoInfo（水印相关信息）

- add_logo: bool，可选  
  - 是否添加水印。true 为添加，false 不添加。默认不添加
- position: int，可选  
  - 水印位置：
    - 0：右下角（默认）
    - 1：左下角
    - 2：左上角
    - 3：右上角
- language: int，可选  
  - 水印语言：
    - 0：中文（“AI生成”）（默认）
    - 1：英文（“Generated by AI”）
- opacity: float，可选  
  - 不透明度，范围 \[0, 1]，1 表示完全不透明，默认 1
- logo_text_content: string，可选  
  - 明水印自定义内容

---

## 6. AIGCMeta（隐式标识）

依据《人工智能生成合成内容标识办法》与《网络安全技术 人工智能生成合成内容标识方法》。

- content_producer: string，可选  
  - 内容生成服务 ID
- producer_id: string，可选  
  - 内容生成服务商给此图片数据的唯一 ID
- content_propagator: string，可选  
  - 内容传播服务商 ID
- propagate_id: string，可选  
  - 传播服务商给此图片数据的唯一 ID

---

## 7. 返回参数

请参考通用返回字段及错误码。业务相关重点字段位于 data 中：

- binary_data_base64: array of string  
  - 返回图片的 base64 数组
- image_urls: array of string  
  - 返回图片的 URL 数组（输出图片为 png 格式）
- status: string  
  - 任务执行状态：
    - in_queue：任务已提交
    - generating：任务已被消费，处理中
    - done：处理完成（成功或失败，需结合外层 code 和 message 判断）
    - not_found：任务未找到（无此任务或任务已过期，过期时效 12 小时）
    - expired：任务已过期，请重提任务

---

## 8. 请求示例（示意）

````json
POST /?Action=CVSync2AsyncGetResult&Version=2022-08-31
Host: visual.volcengineapi.com
Content-Type: application/json
X-Date: 20220901T120000Z
Authorization: ...签名...
{
  "req_key": "jimeng_t2i_v31",
  "task_id": "your_task_id_from_submit_api",
  "req_json": "{\"return_url\":true,\"logo_info\":{\"add_logo\":true,\"position\":0,\"language\":0,\"opacity\":1,\"logo_text_content\":\"这里是明水印内容\"},\"aigc_meta\":{\"content_producer\":\"producer_service_id\",\"producer_id\":\"unique_image_id\"}}"
}
````

## 9. 返回示例（示意）

````json
{
  "code": 0,
  "message": "OK",
  "data": {
    "status": "done",
    "image_urls": [
      "https://.../xxx.png"
    ],
    "binary_data_base64": [
      "iVBORw0KGgoAAAANSUhEUgAA..."
    ]
  },
  "request_id": "20240918xxxxxx"
}
````